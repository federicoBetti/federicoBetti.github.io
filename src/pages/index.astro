---
import BaseLayout from "../layouts/BaseLayout.astro";
import HorizontalCard from "../components/HorizontalCard.astro";
import { getCollection } from "astro:content";

// Get the most recent research papers
const papers = (await getCollection("research-papers")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
const recent_papers = papers.slice(0, 2);

// Get the latest job experience (Typewise)
const experiences = await getCollection("work-experience");
const latest_job = experiences.find(
  (exp) => exp.slug === "typewise-senior-ai-engineer",
);
---

<BaseLayout sideBarActiveItemID="home">
  <div class="pb-12 mt-5">
    <div class="flex flex-col">
      <div class="flex-1">
        <div class="text-xl py-1">Hey there ðŸ‘‹</div>
        <div class="text-5xl font-bold">I'm Federico Betti</div>
        <div class="text-3xl py-3 font-bold">
          Researcher, AI Engineer and Startup Enthusiast
        </div>
        <div class="py-2">
          <text class="text-lg">
            I'm a Computer Engineer with a focus on AI research and development,
            currently pursuing my PhD at the University of Trento while serving
            as Senior AI Engineer at Typewise - ETH Zurich. My work spans
            natural language processing, generative AI, and efficient ML
            implementations.
          </text>
        </div>
        <div class="mt-8 flex gap-4 flex-wrap">
          <a
            class="btn btn-primary rounded-none"
            href="https://www.linkedin.com/in/federico-betti-13919a134/"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Connect with Federico on LinkedIn"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              class="mr-2"
              style="fill: currentColor;transform: ;msFilter:;"
              ><circle cx="4.983" cy="5.009" r="2.188"></circle><path
                d="M9.237 8.855v12.139h3.769v-6.003c0-1.584.298-3.118 2.262-3.118 1.937 0 1.961 1.811 1.961 3.218v5.904H21v-6.657c0-3.27-.704-5.783-4.526-5.783-1.835 0-3.065 1.007-3.568 1.96h-.051v-1.66H9.237zm-6.142 0H6.87v12.139H3.095z"
              ></path></svg
            >
            Let's connect
          </a>
          <a
            class="btn btn-outline btn-primary rounded-none"
            href="/BettiFedericoCV_Long.pdf"
            target="_blank"
            rel="noopener noreferrer"
            aria-label="Download Federico's CV"
            download="Federico_Betti_CV.pdf"
          >
            ðŸ“„ Download CV
          </a>
        </div>
      </div>
    </div>
  </div>

  <div class="flex items-center justify-between mt-10 mb-5">
    <div class="text-3xl w-full font-bold">Current Position</div>
    <a href="/work-experience" class="link text-sm ml-4 whitespace-nowrap"
      >See others â†’</a
    >
  </div>

  {
    latest_job && (
      <>
        <HorizontalCard
          title={latest_job.data.title + " at " + latest_job.data.company}
          desc={latest_job.data.description}
          url={`/work-experience/${latest_job.slug}`}
          target="_self"
          tags={latest_job.data.tags}
        />
        <div class="divider my-0" />
      </>
    )
  }

  <div>
    <div class="text-3xl w-full font-bold mb-5 mt-10">Recent Research</div>
  </div>

  {
    recent_papers.map((paper) => (
      <>
        <div class="relative">
          <HorizontalCard
            title={paper.data.title}
            img={paper.data.heroImage}
            desc={paper.data.description}
            url={paper.data.link || `/research-papers/${paper.slug}`}
            target={paper.data.link ? "_blank" : "_self"}
            badge={paper.data.badge}
            tags={paper.data.tags}
            titleClass=""
          >
            <div slot="extra" class="mt-3">
              <div class="text-xs opacity-60">
                {paper.data.conference} | Published:{" "}
                {new Date(paper.data.pubDate).toLocaleDateString("en-US", {
                  year: "numeric",
                  month: "long",
                })}
              </div>
              <div class="text-xs opacity-80 mt-2">
                Authors: {paper.data.authors}
              </div>

              {paper.data.pdfUrl && (
                <div class="mt-4">
                  <a
                    href={paper.data.pdfUrl}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="btn btn-sm btn-outline btn-primary rounded-none md:inline md:p-2 md:text-sm px-4"
                    aria-label={`View PDF of ${paper.data.title}`}
                  >
                    View PDF
                  </a>
                </div>
              )}
            </div>
          </HorizontalCard>
        </div>
        <div class="divider my-0" />
      </>
    ))
  }
</BaseLayout>

<style>
  @media (max-width: 768px) {
    .btn-outline.btn-primary {
      display: inline-block !important;
      padding-top: 0.4rem !important;
      padding-bottom: 0.4rem !important;
      padding-left: 1rem !important;
      padding-right: 1rem !important;
      font-size: 0.95rem !important;
    }
  }
</style>
