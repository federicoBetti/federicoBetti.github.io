---
import BaseLayout from "../layouts/BaseLayout.astro";
import HorizontalCard from "../components/HorizontalCard.astro";
import { getCollection } from "astro:content";

const papers = (await getCollection("research-papers")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<BaseLayout title="Research Papers" sideBarActiveItemID="research-papers">
    <div class="mb-5">
        <div class="text-3xl w-full font-bold">Research Papers</div>
    </div>

    <div class="relative pl-5 mb-10">
        <span
            class="pointer-events-none absolute left-1 top-0 bottom-0 w-[2px] bg-primary"
        ></span>
        <div class="grid gap-6">
            {
                papers.map((paper) => (
                    <div class="relative">
                        <HorizontalCard
                            title={paper.data.title}
                            img={paper.data.heroImage}
                            desc={paper.data.description}
                            url={
                                paper.data.link ||
                                `/research-papers/${paper.slug}`
                            }
                            target={paper.data.link ? "_blank" : "_self"}
                            badge={paper.data.badge}
                            tags={paper.data.tags}
                            titleClass=""
                            contentClass="px-2 md:px-3"
                        >
                            <div slot="extra" class="mt-3">
                                <div class="text-xs opacity-60">
                                    {paper.data.conference} | Published:{" "}
                                    {new Date(
                                        paper.data.pubDate,
                                    ).toLocaleDateString("en-US", {
                                        year: "numeric",
                                        month: "long",
                                    })}
                                </div>
                                <div class="text-xs opacity-80 mt-2">
                                    Authors: {paper.data.authors}
                                </div>

                                {paper.data.pdfUrl && (
                                    <div class="mt-4">
                                        <a
                                            href={paper.data.pdfUrl}
                                            target="_blank"
                                            rel="noopener noreferrer"
                                            class="btn btn-sm btn-outline btn-primary rounded-none md:inline md:p-2 md:text-sm px-4"
                                            aria-label={`View PDF of ${paper.data.title}`}
                                        >
                                            View PDF
                                        </a>
                                    </div>
                                )}
                            </div>
                        </HorizontalCard>
                    </div>
                ))
            }
        </div>
    </div>
</BaseLayout>
